<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>הצטרפו לרשת MULTIBRAWN - בעלי מתחמים</title>
  <meta name="description" content="יש לכם צימר, וילה, דירת נופש או מקום לאירועים? הצטרפו לרשת MULTIBRAWN וקבלו יותר הזמנות!" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800;900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  <style>
        :root {
            --primary-bg: #1a0b2e;
            --secondary-bg: #16213e;
            --accent-purple: #7c3aed;
            --light-purple: #a855f7;
            --dark-purple: #5b21b6;
            --text-light: #f8fafc;
            --text-muted: #cbd5e1;
            --success: #10b981;
            --warning: #f59e0b;
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Heebo', sans-serif;
            --cta-turquoise: #40E0D0;
            --accent-gold: #ffd700;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-body); background: var(--primary-bg); color: var(--text-light); line-height: 1.7; overflow-x: hidden; }

        /* Navigation */
        .header-nav { position: fixed; top: 0; width: 100%; z-index: 1000; background: rgba(26, 11, 46, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(124, 58, 237, 0.2); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .nav-content { display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; padding: 20px 40px; }
        .logo { font-family: var(--font-heading); font-size: 2rem; font-weight: 900; color: transparent; background: linear-gradient(45deg, #f8fafc, #7c3aed, #a855f7); background-clip: text; -webkit-background-clip: text; text-decoration: none; transition: all 0.3s ease; }
        .nav-menu { display: flex; list-style: none; gap: 40px; align-items: center; }
        .nav-menu a { color: var(--text-muted); text-decoration: none; font-weight: 500; font-size: 1rem; transition: all 0.3s ease; position: relative; padding: 8px 0; }
        .nav-menu a::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background: var(--accent-purple); transition: width 0.3s ease; }
        .nav-menu a:hover { color: var(--text-light); }
        .nav-menu a:hover::after { width: 100%; }
        .cta-button { background: linear-gradient(135deg, var(--accent-purple), var(--dark-purple)); color: white; padding: 12px 28px; border: none; border-radius: 50px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-decoration: none; box-shadow: 0 4px 20px rgba(124, 58, 237, 0.3); }

        /* Hero */
        .hero { min-height: 100vh; display: flex; align-items: center; position: relative; background: url('https://raw.githubusercontent.com/kfischi/MULTIBRAWN-V.1/main/Gallery/Villa1.jpg'); background-size: cover; background-position: center; background-attachment: fixed; }
        .hero::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, rgba(26, 11, 46, 0.8) 0%, rgba(22, 33, 62, 0.6) 50%, rgba(91, 33, 182, 0.7) 100%); z-index: 1; }
        .hero-content { max-width: 1200px; margin: 0 auto; padding: 0 2rem; display: flex; align-items: center; min-height: 80vh; justify-content: center; z-index: 2; position: relative; }
        .hero-text { text-align: center; max-width: 800px; }
        .hero-title { font-family: var(--font-heading); font-size: clamp(3rem, 8vw, 6rem); font-weight: 900; background: linear-gradient(135deg, var(--accent-gold) 0%, #fff 30%, var(--light-purple) 60%, var(--accent-gold) 100%); background-size: 300% 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shimmer 4s ease-in-out infinite; margin-bottom: 2rem; text-shadow: 0 0 50px rgba(255, 255, 255, 0.5); }
        @keyframes shimmer { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .hero-subtitle { font-size: clamp(1.5rem, 4vw, 2.5rem); color: var(--text-light); font-weight: 700; margin-bottom: 1.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.7); }
        .hero-description { font-size: clamp(1.1rem, 2.5vw, 1.4rem); color: var(--text-light); line-height: 1.8; text-shadow: 1px 1px 2px rgba(0,0,0,0.7); margin-bottom: 3rem; }
        .hero-cta { background: linear-gradient(135deg, var(--cta-turquoise), var(--light-purple)); color: white; padding: 18px 40px; border: none; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 25px rgba(64, 224, 208, 0.4); text-decoration: none; display: inline-block; }
        .hero-cta:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(64, 224, 208, 0.6); }

        /* Chat Section */
        .chat-section { padding: 4rem 2rem; background: linear-gradient(135deg, var(--secondary-bg) 0%, var(--primary-bg) 100%); }
        .chat-container { max-width: 900px; margin: 0 auto; background: rgba(15, 12, 41, 0.8); border-radius: 25px; border: 1px solid rgba(124, 58, 237, 0.3); backdrop-filter: blur(20px); overflow: hidden; box-shadow: 0 20px 60px rgba(124, 58, 237, 0.2); }
        .chat-header { background: rgba(26, 11, 46, 0.9); padding: 1.5rem 2rem; border-bottom: 1px solid rgba(139, 95, 191, 0.3); text-align: center; }
        .chat-title { font-family: var(--font-heading); font-size: 1.8rem; font-weight: 900; color: var(--text-light); margin-bottom: 0.5rem; }
        .chat-subtitle { font-size: 1rem; color: var(--text-muted); }
        .progress-container { background: rgba(15, 12, 41, 0.8); padding: 1rem 2rem; border-bottom: 1px solid rgba(139, 95, 191, 0.2); }
        .progress-bar { width: 100%; height: 6px; background: rgba(139, 95, 191, 0.2); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--cta-turquoise), var(--light-purple)); border-radius: 3px; transition: width 0.5s ease; width: 0%; }
        .progress-text { margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted); text-align: center; }
        .chat-messages { height: 500px; overflow-y: auto; padding: 2rem; background: linear-gradient(135deg, #0f0c29 0%, #24243e 50%, #302b63 100%); position: relative; }
        .chat-messages::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 20% 20%, rgba(64, 224, 208, 0.05) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(139, 95, 191, 0.05) 0%, transparent 50%); pointer-events: none; z-index: 1; }
        .messages-container { position: relative; z-index: 2; }
        .message { margin-bottom: 2rem; opacity: 0; transform: translateY(20px); animation: messageAppear 0.6s ease forwards; }
        @keyframes messageAppear { to { opacity: 1; transform: translateY(0); } }
        .message.bot { text-align: right; }
        .message.user { text-align: left; }
        .message-bubble { display: inline-block; max-width: 70%; padding: 1.5rem 2rem; border-radius: 25px; position: relative; word-wrap: break-word; }
        .message.bot .message-bubble { background: linear-gradient(135deg, rgba(139, 95, 191, 0.2), rgba(64, 224, 208, 0.1)); border: 1px solid rgba(139, 95, 191, 0.3); color: var(--text-light); }
        .message.user .message-bubble { background: linear-gradient(135deg, var(--cta-turquoise), var(--light-purple)); color: var(--text-light); box-shadow: 0 8px 25px rgba(64, 224, 208, 0.3); }
        .message-avatar { width: 40px; height: 40px; border-radius: 50%; margin: 0 1rem; display: inline-flex; align-items: center; justify-content: center; font-size: 1.2rem; vertical-align: top; }
        .message.bot .message-avatar { background: linear-gradient(135deg, var(--accent-purple), var(--light-purple)); order: 2; }
        .message.user .message-avatar { background: linear-gradient(135deg, var(--accent-gold), #ffed4e); color: var(--primary-bg); }
        .typing-indicator { display: none; align-items: center; gap: 1rem; margin-bottom: 1rem; opacity: 0.7; }
        .typing-dots { display: flex; gap: 4px; }
        .typing-dot { width: 8px; height: 8px; background: var(--light-purple); border-radius: 50%; animation: typingPulse 1.4s infinite ease-in-out; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typingPulse { 0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }
        .response-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem; }
        .response-option { background: rgba(15, 12, 41, 0.8); border: 2px solid rgba(139, 95, 191, 0.3); border-radius: 15px; padding: 1.5rem; cursor: pointer; transition: all 0.3s ease; text-align: center; position: relative; overflow: hidden; }
        .response-option::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(64, 224, 208, 0.1), transparent); transition: left 0.5s ease; }
        .response-option:hover::before { left: 100%; }
        .response-option:hover { border-color: var(--cta-turquoise); transform: translateY(-3px); box-shadow: 0 8px 25px rgba(64, 224, 208, 0.2); }
        .option-icon { font-size: 2rem; margin-bottom: 1rem; display: block; }
        .option-title { font-weight: 700; margin-bottom: 0.5rem; color: var(--text-light); }
        .option-desc { font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; }
        .input-section { margin-top: 1.5rem; }
        .input-group { margin-bottom: 1rem; position: relative; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-light); }
        .chat-input { width: 100%; padding: 12px 16px; background: rgba(15, 12, 41, 0.8); border: 2px solid rgba(139, 95, 191, 0.3); border-radius: 12px; color: var(--text-light); font-size: 1rem; transition: all 0.3s ease; }
        .chat-input:focus { outline: none; border-color: var(--cta-turquoise); box-shadow: 0 0 0 3px rgba(64, 224, 208, 0.1); }
        .chat-input::placeholder { color: var(--text-muted); }
        .checkbox-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; margin-top: 1rem; }
        .checkbox-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.8rem; background: rgba(15, 12, 41, 0.5);
</head>
<body>
  <header class="header-nav">
    <nav class="nav-content">
      <a href="index.html" class="logo">Multibrawn</a>
      <ul class="nav-menu" id="navMenu">
        <li><a href="index.html">דף הבית</a></li>
        <li><a href="about.html">אודות</a></li>
        <li><a href="gallery.html">גלריה</a></li>
        <li><a href="marketing.html">שיווק דיגיטלי</a></li>
        <li><a href="contact.html">צור קשר</a></li>
        <li><a href="contact.html" class="cta-button">קבלו הצעה</a></li>
      </ul>
      <button class="mobile-menu-toggle" id="mobileToggle">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-content">
      <div class="hero-text">
        <h1 class="hero-title">בעלי מתחמים - בואו לעבוד איתנו</h1>
        <h2 class="hero-subtitle">הצטרפו למשפחת MULTIBRAWN והתחילו להרוויח יותר!</h2>
        <p class="hero-description">יש לכם צימר, וילה, דירת נופש או מקום לאירועים?<br />בואו נעזור לכם להגדיל את ההכנסות ולהגיע ליותר לקוחות איכותיים</p>
        <a href="#chat" class="hero-cta">התחילו עכשיו!</a>
      </div>
    </div>
  </section>

  <section class="chat-section" id="chat">
    <div class="chat-container">
      <div class="chat-header">
        <div class="chat-title">השאלון החכם שלנו</div>
        <div class="chat-subtitle">ספרו לנו על המתחם שלכם ונתחיל לעבוד יחד</div>
        <button id="restartBtn" style="background: var(--accent-purple); color: white; border: none; padding: 8px 16px; border-radius: 20px; font-size: 0.9rem; cursor: pointer; margin-top: 10px;">התחל מחדש</button>
      </div>
      <div class="progress-container">
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="progress-text" id="progressText">שלב 1 מתוך 10</div>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="messages-container" id="messagesContainer">
          <div class="typing-indicator" id="typingIndicator">
            <div class="message-avatar">🏡</div>
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
            <span>כותב...</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-social">
        <a href="#" title="פייסבוק"><i class="fab fa-facebook"></i></a>
        <a href="#" title="אינסטגרם"><i class="fab fa-instagram"></i></a>
        <a href="#" title="לינקדאין"><i class="fab fa-linkedin"></i></a>
      </div>
      <p style="color: var(--text-muted);">© 2024 Multibrawn. כל הזכויות שמורות.</p>
    </div>
  </footer>

  <a href="https://wa.me/972523983394?text=שלום, אני מעוניין לשמוע על אפשרויות שיתוף פעולה" class="floating-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i></a>

  <script>
    class PropertyOwnerChat {
      constructor() {
        this.currentStep = 0;
        this.userResponses = {};
        this.messagesContainer = document.getElementById('messagesContainer');
        this.typingIndicator = document.getElementById('typingIndicator');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');

        this.conversationFlow = [
          { id: 'welcome', botMessage: 'שלום וברכה! 🏡\n\nמעוניינים להצטרף למשפחת MULTIBRAWN ולפרסם את הנכס שלכם?\n\nיש לכם צימר, וילה, דירת נופש או מקום לאירועים? בואו נכיר ונראה איך אנחנו יכולים לעבוד ביחד ולעזור לכם להגדיל את ההכנסות!', responseType: 'options', options: [ { text: 'כן, יש לנו מתחם!', value: 'yes', icon: '✅' }, { text: 'אני רק מתעניין', value: 'curious', icon: '🤔' }, { text: 'בתכנון להקים מתחם', value: 'planning', icon: '📋' } ] },
          { id: 'property_type', botMessage: 'מעולה! 🌟 \n\nבואו נתחיל להכיר את המתחם שלכם.\nאיזה סוג נכס יש לכם?', responseType: 'options', options: [ { text: 'צימר רומנטי', value: 'zimmer', icon: '💕', desc: 'לזוגות ומשפחות קטנות' }, { text: 'וילה פרטית', value: 'villa', icon: '🏡', desc: 'עם בריכה וגינה' }, { text: 'דירת נופש', value: 'apartment', icon: '🏢', desc: 'במרכז העיר או ליד הים' }, { text: 'מלון בוטיק', value: 'boutique_hotel', icon: '🏨', desc: 'מלון קטן ואינטימי' }, { text: 'אולם אירועים', value: 'event_hall', icon: '🎉', desc: 'לחתונות ואירועים' }, { text: 'גן אירועים', value: 'event_garden', icon: '🌳', desc: 'אירועים בטבע' }, { text: 'משהו אחר', value: 'other', icon: '🏘️', desc: 'ספרו לנו בהמשך' } ] },
          { id: 'location', botMessage: 'נהדר! 📍\n\nבאיזה אזור בארץ נמצא המתחם שלכם?', responseType: 'options', options: [ { text: 'צפון', value: 'north', icon: '🏔️', desc: 'גליל, גולן, חיפה והקריות' }, { text: 'מרכז', value: 'center', icon: '🏙️', desc: 'תל אביב, רמת גן, הרצליה' }, { text: 'ירושלים והסביבה', value: 'jerusalem', icon: '🕌', desc: 'ירושלים ויהודה ושומרון' }, { text: 'דרום', value: 'south', icon: '🏜️', desc: 'באר שבע, אילת, הנגב' }, { text: 'שרון', value: 'sharon', icon: '🌾', desc: 'נתניה, כפר סבא, רעננה' }, { text: 'שפלה', value: 'shephelah', icon: '🌻', desc: 'רחובות, רמלה, בית שמש' } ] },
          { id: 'target_audience', botMessage: 'מצוין! 👥\n\nלמי המתחם שלכם הכי מתאים? (תוכלו לבחור כמה אפשרויות)', responseType: 'multi_select', options: [ { text: 'זוגות רומנטיים', value: 'couples', icon: '💕' }, { text: 'משפחות עם ילדים', value: 'families', icon: '👨‍👩‍👧‍👦' }, { text: 'קבוצות חברים', value: 'friends', icon: '👥' }, { text: 'קהל דתי', value: 'religious', icon: '✡️' }, { text: 'אירועי חברה', value: 'corporate', icon: '💼' }, { text: 'חתונות', value: 'weddings', icon: '💒' }, { text: 'בר/בת מצווה', value: 'bar_mitzvah', icon: '🎭' }, { text: 'אירועים פרטיים', value: 'private_events', icon: '🎉' } ] },
          { id: 'capacity', botMessage: 'עכשיו בואו נדבר על הקיבולת 📊\n\nכמה אנשים יכולים להתארח במתחם בו זמנית?', responseType: 'slider', sliderConfig: { min: 2, max: 500, default: 20, unit: 'אנשים', labels: { 2: 'זוג', 6: 'משפחה קטנה', 12: 'קבוצה קטנה', 30: 'אירוע קטן', 80: 'אירוע בינוני', 150: 'אירוע גדול', 300: 'כנס גדול', 500: 'אירוע ענק' } } },
          { id: 'amenities', botMessage: 'איזה כיף! ✨\n\nאיזה מתקנים ושירותים יש לכם? (סמנו את כל מה שחל)', responseType: 'multi_select', options: [ { text: 'בריכה פרטית', value: 'pool', icon: '🏊‍♂️' }, { text: 'ג\'קוזי', value: 'jacuzzi', icon: '🛁' }, { text: 'גינה/מרפסת', value: 'garden', icon: '🌳' }, { text: 'מטבח מאובזר', value: 'kitchen', icon: '🍳' }, { text: 'מתקני ברביקיו', value: 'bbq', icon: '🔥' }, { text: 'חניה פרטית', value: 'parking', icon: '🚗' }, { text: 'מיזוג אוויר', value: 'ac', icon: '❄️' }, { text: 'WiFi מהיר', value: 'wifi', icon: '📶' }, { text: 'מערכת שמע', value: 'sound', icon: '🔊' }, { text: 'חדר כושר', value: 'gym', icon: '💪' }, { text: 'שולחן ביליארד', value: 'billiard', icon: '🎱' }, { text: 'נגישות לנכים', value: 'accessible', icon: '♿' } ] },
          { id: 'age_groups', botMessage: 'כמעט סיימנו! 🎯\n\nלאיזה קבוצות גיל המקום הכי מתאים?', responseType: 'multi_select', options: [ { text: 'זוגות צעירים (20-35)', value: 'young_couples', icon: '💕' }, { text: 'משפחות עם ילדים קטנים', value: 'young_families', icon: '👶' }, { text: 'משפחות עם בני נוער', value: 'teen_families', icon: '👨‍👩‍👧‍👦' }, { text: 'דור הביניים (35-55)', value: 'middle_age', icon: '👫' }, { text: 'גיל הזהב (55+)', value: 'seniors', icon: '👴👵' }, { text: 'מתאים לכל הגילאים', value: 'all_ages', icon: '👥' } ] },
          { id: 'special_features', botMessage: 'מעולה! 🌟\n\nיש למתחם שלכם משהו מיוחד שמבדיל אותו מאחרים? (אופציונלי)', responseType: 'textarea', placeholder: 'למשל: נוף מיוחד, קרבה לאטרקציות, עיצוב ייחודי, היסטוריה מעניינת...' },
          { id: 'contact_info', botMessage: 'נפלא! עכשיו הפרטים שלכם 📞\n\nכדי שנוכל ליצור קשר ולספר לכם על האפשרויות לשיתוף פעולה:', responseType: 'form', fields: [ { type: 'text', name: 'owner_name', label: 'השם שלכם', placeholder: 'איך קוראים לכם?', required: true }, { type: 'text', name: 'property_name', label: 'שם המתחם', placeholder: 'איך קוראים למקום?', required: true }, { type: 'tel', name: 'phone', label: 'טלפון', placeholder: '052-123-4567', required: true }, { type: 'email', name: 'email', label: 'אימייל', placeholder: 'your@email.com', required: true }, { type: 'url', name: 'website', label: 'אתר/פייסבוק (אופציונלי)', placeholder: 'https://...', required: false } ] },
          { id: 'partnership_interest', botMessage: 'כמעט גמרנו! 🤝\n\nמה הכי מעניין אתכם בשיתוף פעולה איתנו?', responseType: 'multi_select', options: [ { text: 'קבלת יותר הזמנות', value: 'more_bookings', icon: '📈' }, { text: 'חשיפה ברשתות החברתיות', value: 'social_exposure', icon: '📱' }, { text: 'אתר אינטרנט מקצועי', value: 'website', icon: '💻' }, { text: 'ניהול לוח שנה', value: 'calendar_management', icon: '📅' }, { text: 'שיווק דיגיטלי מתקדם', value: 'digital_marketing', icon: '🎯' }, { text: 'צילומים מקצועיים', value: 'photography', icon: '📸' }, { text: 'ייעוץ עסקי', value: 'business_consulting', icon: '💡' }, { text: 'רק רוצה לשמוע מה יש', value: 'just_curious', icon: '🤔' } ] }
        ];
        this.startConversation();
      }

      startConversation() {
        setTimeout(() => {
          this.addBotMessage(this.conversationFlow[0].botMessage);
          this.showResponseOptions(this.conversationFlow[0]);
        }, 800);
        this.updateProgress();
      }

      addBotMessage(message, delay = 0) {
        setTimeout(() => {
          this.showTyping();
          setTimeout(() => {
            this.hideTyping();
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
              <div class="message-avatar">🏡</div>
              <div class="message-bubble">${message.replace(/\n/g, '<br>')}</div>
            `;
            this.messagesContainer.appendChild(messageDiv);
            this.scrollToBottom();
          }, Math.random() * 1200 + 600);
        }, delay);
      }

      addUserMessage(message) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message user';
        messageDiv.innerHTML = `
          <div class="message-bubble">${message}</div>
          <div class="message-avatar">👤</div>
        `;
        this.messagesContainer.appendChild(messageDiv);
        this.scrollToBottom();
      }

      showTyping(){ this.typingIndicator.style.display = 'flex'; this.scrollToBottom(); }
      hideTyping(){ this.typingIndicator.style.display = 'none'; }

      showResponseOptions(step){
        const optionsDiv = document.createElement('div');
        optionsDiv.className = 'response-options';
        optionsDiv.id = 'currentOptions';

        // --- Welcome step: only a "start" button ---
        if (step.id === 'welcome') {
          optionsDiv.innerHTML = `
            <div class="input-section" style="text-align:center">
              <button class="continue-btn" id="startQuiz">התחל בשאלון</button>
            </div>
          `;
          this.messagesContainer.appendChild(optionsDiv);
          this.scrollToBottom();
          setTimeout(() => {
            const startBtn = document.getElementById('startQuiz');
            if (startBtn) {
              startBtn.addEventListener('click', () => {
                this.addUserMessage('יאללה, מתחילים!');
                const co = document.getElementById('currentOptions');
                if (co) co.remove();
                this.currentStep++; // move to property_type
                this.proceedToNextStep();
              });
            }
          }, 50);
          return; // don't render the original options
        }

        if (step.responseType === 'options') {
          step.options.forEach(option => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'response-option';
            optionDiv.innerHTML = `
              <span class="option-icon">${option.icon}</span>
              <div class="option-title">${option.text}</div>
              ${option.desc ? `<div class="option-desc">${option.desc}</div>` : ''}
            `;
            optionDiv.addEventListener('click', () => this.handleOptionClick(option.value, option.text));
            optionsDiv.appendChild(optionDiv);
          });
        } else if (step.responseType === 'multi_select') {
          optionsDiv.innerHTML = `
            <div class="input-section">
              <div class="checkbox-group">
                ${step.options.map(o => `
                  <label class="checkbox-item">
                    <input type="checkbox" value="${o.value}">
                    <span>${o.icon} ${o.text}</span>
                  </label>
                `).join('')}
              </div>
              <button class="continue-btn" id="continueMulti">המשך</button>
            </div>`;
          setTimeout(() => {
            const btn = document.getElementById('continueMulti');
            btn.addEventListener('click', () => this.handleMultiSelect(step.options));
          }, 50);
        } else if (step.responseType === 'slider') {
          optionsDiv.innerHTML = `
            <div class="input-section">
              <div class="input-group">
                <label class="input-label">${step.sliderConfig.unit}:</label>
                <input type="range" class="range-input" id="rangeSlider" min="${step.sliderConfig.min}" max="${step.sliderConfig.max}" value="${step.sliderConfig.default}">
                <div class="range-display" id="rangeDisplay">${step.sliderConfig.default} ${step.sliderConfig.unit}</div>
              </div>
              <button class="continue-btn" id="continueBtn">המשך</button>
            </div>`;
          setTimeout(() => {
            const slider = document.getElementById('rangeSlider');
            const display = document.getElementById('rangeDisplay');
            const btn = document.getElementById('continueBtn');
            slider.addEventListener('input', (e) => {
              const v = Number(e.target.value);
              display.textContent = `${v} ${step.sliderConfig.unit}`;
              for (const [t, label] of Object.entries(step.sliderConfig.labels)) {
                if (v >= Number(t)) display.textContent = `${v} ${step.sliderConfig.unit} (${label})`;
              }
            });
            btn.addEventListener('click', () => this.handleOptionClick(slider.value, `${slider.value} ${step.sliderConfig.unit}`));
          }, 50);
        } else if (step.responseType === 'textarea') {
          optionsDiv.innerHTML = `
            <div class="input-section">
              <div class="input-group">
                <textarea class="chat-input" id="textareaInput" placeholder="${step.placeholder}" rows="4"></textarea>
              </div>
              <button class="continue-btn" id="continueTextarea">המשך</button>
            </div>`;
          setTimeout(() => {
            const ta = document.getElementById('textareaInput');
            const btn = document.getElementById('continueTextarea');
            btn.addEventListener('click', () => {
              const v = (ta.value || '').trim();
              this.handleOptionClick(v || 'לא צוין', v || 'לא צוין');
            });
          }, 50);
        } else if (step.responseType === 'form') {
          optionsDiv.innerHTML = `
            <div class="input-section">
              ${step.fields.map(f => f.type === 'textarea' ? `
                <div class="input-group">
                  <label class="input-label">${f.label}</label>
                  <textarea class="chat-input" name="${f.name}" placeholder="${f.placeholder}" ${f.required ? 'required' : ''} rows="3"></textarea>
                </div>` : `
                <div class="input-group">
                  <label class="input-label">${f.label}</label>
                  <input type="${f.type}" class="chat-input" name="${f.name}" placeholder="${f.placeholder}" ${f.required ? 'required' : ''}>
                </div>`).join('')}
              <button class="continue-btn" id="submitForm">שלח פרטים</button>
            </div>`;
          setTimeout(() => {
            const btn = document.getElementById('submitForm');
            btn.addEventListener('click', () => this.handleFormSubmit(step.fields));
          }, 50);
        }

        this.messagesContainer.appendChild(optionsDiv);
        this.scrollToBottom();
      }

      handleOptionClick(value, displayText){
        this.userResponses[this.conversationFlow[this.currentStep].id] = value;
        this.addUserMessage(displayText);
        const co = document.getElementById('currentOptions');
        if (co) co.remove();
        this.currentStep++;
        this.proceedToNextStep();
      }

      handleMultiSelect(options){
        const co = document.getElementById('currentOptions');
        const checked = co ? co.querySelectorAll('input[type="checkbox"]:checked') : [];
        const values = Array.from(checked).map(cb => cb.value);
        if (!values.length) { this.addBotMessage('אנא בחרו לפחות אפשרות אחת 😊'); return; }
        const texts = values.map(v => { const o = options.find(x => x.value === v); return o ? `${o.icon} ${o.text}` : v; });
        this.userResponses[this.conversationFlow[this.currentStep].id] = values;
        this.addUserMessage(texts.join('<br>'));
        if (co) co.remove();
        this.currentStep++;
        this.proceedToNextStep();
      }

      handleFormSubmit(fields){
        const formData = {}; let isValid = true; const errors = [];
        fields.forEach(f => {
          const input = document.querySelector(`[name="${f.name}"]`);
          const val = (input.value || '').trim();
          input.style.borderColor = 'rgba(139, 95, 191, 0.3)';
          if (f.required && !val){ isValid = false; input.style.borderColor = '#ef4444'; errors.push(`השדה "${f.label}" הוא חובה`); return; }
          if (f.name === 'phone' && val){
            let clean = val.replace(/[^\d+]/g, '');
            if (clean.startsWith('+972')) clean = '0' + clean.slice(4);
            clean = clean.replace(/\D/g, '');
            if (clean.length < 9 || clean.length > 10){ isValid = false; input.style.borderColor = '#ef4444'; errors.push('מספר הטלפון לא תקין (ישראל)'); } else { formData[f.name] = clean; return; }
          }
          if (f.name === 'email' && val){ const re=/^[^\s@]+@[^\s@]+\.[^\s@]+$/; if (!re.test(val)){ isValid=false; input.style.borderColor='#ef4444'; errors.push('כתובת האימייל לא תקינה'); } }
          if (f.name === 'website' && val){ const urlRe=/^(https?:\/\/)?([a-z0-9-]+\.)+[a-z]{2,}(\/\S*)?$/i; if (!urlRe.test(val)){ isValid=false; input.style.borderColor='#ef4444'; errors.push('כתובת האתר לא תקינה'); } }
          formData[f.name] = val;
        });
        if (!isValid){ this.addBotMessage(`אופס! יש כמה בעיות בפרטים: 😅\n\n• ${errors.join('\n• ')}\n\nאנא תקנו ונסו שוב.`); return; }
        this.userResponses.contactInfo = formData;
        let disp = `שם: ${formData.owner_name}\nשם המתחם: ${formData.property_name}\nטלפון: ${formData.phone}\nאימייל: ${formData.email}`;
        if (formData.website) disp += `\nאתר: ${formData.website}`;
        this.addUserMessage(disp);
        const co = document.getElementById('currentOptions'); if (co) co.remove();
        this.currentStep++; this.proceedToNextStep();
      }

      proceedToNextStep(){
        if (this.currentStep < this.conversationFlow.length){
          const next = this.conversationFlow[this.currentStep];
          this.updateProgress();
          setTimeout(() => { this.addBotMessage(next.botMessage); setTimeout(() => this.showResponseOptions(next), 1000); }, 400);
        } else { this.generateFinalMessage(); }
      }

      createWhatsAppMessage(){
        const r = this.userResponses; const c = r.contactInfo || {};
        let msg = `🏡 בקשה להצטרפות לרשת MULTIBRAWN\n\n`;
        msg += `👤 פרטי הבעלים:\n`;
        msg += `• שם: ${c.owner_name}\n`;
        msg += `• טלפון: ${c.phone}\n`;
        msg += `• אימייל: ${c.email}\n`;
        if (c.website) msg += `• אתר: ${c.website}\n`;
        msg += `\n🏡 פרטי המתחם:\n`;
        msg += `• שם המתחם: ${c.property_name}\n`;
        const types={zimmer:'צימר רומנטי',villa:'וילה פרטית',apartment:'דירת נופש',boutique_hotel:'מלון בוטיק',event_hall:'אולם אירועים',event_garden:'גן אירועים',other:'אחר'};
        msg += `• סוג נכס: ${types[r.property_type] || r.property_type}\n`;
        const locs={north:'צפון (גליל, גולן, חיפה)',center:'מרכז (תל אביב, רמת גן)',jerusalem:'ירושלים והסביבה',south:'דרום (באר שבע, אילת, נגב)',sharon:'שרון (נתניה, כפר סבא)',shephelah:'שפלה (רחובות, רמלה)'};
        msg += `• מיקום: ${locs[r.location] || r.location}\n`;
        if (r.capacity) msg += `• קיבולת: ${r.capacity} אנשים\n`;
        if (r.target_audience?.length){ const map={couples:'זוגות רומנטיים',families:'משפחות עם ילדים',friends:'קבוצות חברים',religious:'קהל דתי',corporate:'אירועי חברה',weddings:'חתונות',bar_mitzvah:'בר/בת מצווה',private_events:'אירועים פרטיים'}; msg += `• קהל יעד: ${r.target_audience.map(a=>map[a]||a).join(', ')}\n`; }
        if (r.age_groups?.length){ const map={young_couples:'זוגות צעירים (20-35)',young_families:'משפחות עם ילדים קטנים',teen_families:'משפחות עם בני נוער',middle_age:'דור הביניים (35-55)',seniors:'גיל הזהב (55+)',all_ages:'מתאים לכל הגילאים'}; msg += `• קבוצות גיל: ${r.age_groups.map(a=>map[a]||a).join(', ')}\n`; }
        if (r.amenities?.length){ const map={pool:'בריכה פרטית',jacuzzi:'ג\'קוזי',garden:'גינה/מרפסת',kitchen:'מטבח מאובזר',bbq:'מתקני ברביקיו',parking:'חניה פרטית',ac:'מיזוג אוויר',wifi:'WiFi מהיר',sound:'מערכת שמע',gym:'חדר כושר',billiard:'שולחן ביליארד',accessible:'נגישות לנכים'}; msg += `• מתקנים: ${r.amenities.map(x=>map[x]||x).join(', ')}\n`; }
        if (r.special_features && r.special_features !== 'לא צוין') msg += `• מה מיוחד במתחם: ${r.special_features}\n`;
        if (r.partnership_interest?.length){ const map={more_bookings:'קבלת יותר הזמנות',social_exposure:'חשיפה ברשתות החברתיות',website:'אתר אינטרנט מקצועי',calendar_management:'ניהול לוח שנה',digital_marketing:'שיווק דיגיטלי מתקדם',photography:'צילומים מקצועיים',business_consulting:'ייעוץ עסקי',just_curious:'רק רוצה לשמוע מה יש'}; msg += `\n💼 מעוניין ב: ${r.partnership_interest.map(i=>map[i]||i).join(', ')}\n`; }
        msg += `\n🤝 מחכה לשמוע מכם לגבי אפשרויות שיתוף הפעולה!`;
        return msg;
      }

      generateFinalMessage(){
        this.addBotMessage('מושלם! תנו לי רגע לכתוב עבורכם סיכום מפורט... ✨');
        setTimeout(()=>{
          const message=this.createWhatsAppMessage();
          const final=document.createElement('div');
          final.className='whatsapp-section';
          final.innerHTML=`
            <div class="whatsapp-icon">💬</div>
            <h3 class="whatsapp-title">הבקשה שלכם מוכנה!</h3>
            <p style="color: var(--text-muted); margin-bottom: 1rem;">הנה סיכום המידע על המתחם שלכם - נשלח ישירות לצוות MULTIBRAWN</p>
            <div class="whatsapp-preview">${message.replace(/\n/g,'<br>')}</div>
            <a href="https://wa.me/972523983394?text=${encodeURIComponent(message)}" class="whatsapp-btn" target="_blank"><i class="fab fa-whatsapp"></i>שלח ב-WhatsApp</a>`;
          this.messagesContainer.appendChild(final);
          this.scrollToBottom();
        },1500);
      }

      updateProgress(){
        const total=this.conversationFlow.length;
        const progress=(this.currentStep/total)*100;
        this.progressFill.style.width=progress+'%';
        this.progressText.textContent=`שלב ${this.currentStep+1} מתוך ${total}`;
      }

      scrollToBottom(){ setTimeout(()=>{ const el=document.getElementById('chatMessages'); el.scrollTop=el.scrollHeight; },100); }
    }

    function setupMobileMenu(){ const t=document.getElementById('mobileToggle'); const m=document.querySelector('.nav-menu'); if(t&&m){ t.addEventListener('click',()=>m.classList.toggle('active')); } }
    function setupSmoothScrolling(){ document.querySelectorAll('a[href^="#"]').forEach(a=>{ a.addEventListener('click',e=>{ e.preventDefault(); const target=document.querySelector(a.getAttribute('href')); if(target) target.scrollIntoView({behavior:'smooth',block:'start'}); }); }); }
    function setupScrollEffects(){ window.addEventListener('scroll',()=>{ const nav=document.querySelector('.header-nav'); nav.style.background=(window.scrollY>100)?'rgba(26, 11, 46, 0.98)':'rgba(26, 11, 46, 0.95)'; }); }

    document.addEventListener('DOMContentLoaded',()=>{
      new PropertyOwnerChat();
      setupMobileMenu();
      setupSmoothScrolling();
      setupScrollEffects();
      const rb=document.getElementById('restartBtn');
      if(rb) rb.addEventListener('click',()=>location.reload());
    });
  </script>
</body>
</html>
