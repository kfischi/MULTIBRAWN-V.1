<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>צור קשר - MULTIBRAWN</title>
    <meta name="description" content="צרו קשר עם MULTIBRAWN - נשמח לעזור לכם למצוא את הלוקיישן המושלם או לשפר את השיווק הדיגיטלי שלכם">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        :root {
            --primary-bg: #FFFFFF;
            --secondary-bg: #f5f3ff;
            --brand-purple: #8B5FBF;
            --silver-gray: #C0C0C0;
            --cta-turquoise: #40E0D0;
            --text-dark: #2d3748;
            --text-muted: #718096;
            --accent-yellow: #f59e0b;
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Heebo', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-body); background: var(--primary-bg); color: var(--text-dark); line-height: 1.7; overflow-x: hidden; }

        /* Navigation */
        .header-nav { position: fixed; top: 0; width: 100%; z-index: 1000; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #e2e8f0; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; padding: 20px 40px; }
        .logo-container { display: flex; align-items: center; gap: 15px; }
        .logo-img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; }
        .logo { font-family: var(--font-heading); font-size: 2rem; font-weight: 900; color: var(--text-dark); text-decoration: none; }
        .nav-menu { display: flex; list-style: none; gap: 28px; align-items: center; }
        .nav-menu a { color: var(--text-muted); text-decoration: none; font-weight: 600; transition: color 0.3s ease; }
        .nav-menu a:hover { color: var(--brand-purple); }
        .nav-menu a.active { color: var(--brand-purple); font-weight: 700; }

        /* Hero Section */
        .hero { min-height: 40vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--brand-purple) 0%, #a78bca 100%); text-align: center; color: white; padding-top: 100px; }
        .hero-content { max-width: 800px; padding: 3rem 2rem; }
        .hero-title { font-family: var(--font-heading); font-size: clamp(2.5rem, 6vw, 4rem); font-weight: 900; margin-bottom: 1rem; }
        .hero-subtitle { font-size: clamp(1.2rem, 3vw, 1.6rem); opacity: 0.95; line-height: 1.6; }

        /* Chat Section */
        .chat-section { padding: 4rem 2rem; background: var(--secondary-bg); }
        .chat-container { max-width: 900px; margin: 0 auto; background: white; border-radius: 25px; border: 1px solid #e2e8f0; overflow: hidden; box-shadow: 0 20px 60px rgba(139, 95, 191, 0.15); }
        .chat-header { background: linear-gradient(135deg, var(--brand-purple), #a78bca); padding: 1.5rem 2rem; text-align: center; color: white; }
        .chat-title { font-family: var(--font-heading); font-size: 1.8rem; font-weight: 900; margin-bottom: 0.5rem; }
        .chat-subtitle { font-size: 1rem; opacity: 0.95; }
        .restart-btn { background: rgba(255, 255, 255, 0.2); color: white; border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; cursor: pointer; transition: all 0.3s ease; margin-top: 10px; }
        .restart-btn:hover { background: rgba(255, 255, 255, 0.3); transform: translateY(-2px); }
        
        .progress-container { background: #f8f9fa; padding: 1rem 2rem; border-bottom: 1px solid #e2e8f0; }
        .progress-bar { width: 100%; height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--cta-turquoise), var(--brand-purple)); border-radius: 3px; transition: width 0.5s ease; width: 0%; }
        .progress-text { margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted); text-align: center; }
        
        .chat-messages { height: 500px; overflow-y: auto; padding: 2rem; background: linear-gradient(135deg, #fafafa 0%, #f5f3ff 100%); }
        .messages-container { position: relative; z-index: 2; }
        .message { margin-bottom: 2rem; opacity: 0; transform: translateY(20px); animation: messageAppear 0.6s ease forwards; }
        @keyframes messageAppear { to { opacity: 1; transform: translateY(0); } }
        .message.bot { text-align: right; }
        .message.user { text-align: left; }
        .message-bubble { display: inline-block; max-width: 70%; padding: 1.5rem 2rem; border-radius: 25px; word-wrap: break-word; }
        .message.bot .message-bubble { background: white; border: 1px solid #e2e8f0; color: var(--text-dark); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .message.user .message-bubble { background: linear-gradient(135deg, var(--cta-turquoise), #5ce1e6); color: white; box-shadow: 0 4px 15px rgba(64, 224, 208, 0.3); }
        .message-avatar { width: 40px; height: 40px; border-radius: 50%; margin: 0 1rem; display: inline-flex; align-items: center; justify-content: center; font-size: 1.2rem; vertical-align: top; }
        .message.bot .message-avatar { background: linear-gradient(135deg, var(--brand-purple), #a78bca); color: white; }
        .message.user .message-avatar { background: linear-gradient(135deg, var(--accent-yellow), #ffb84d); color: var(--text-dark); }
        
        .typing-indicator { display: none; align-items: center; gap: 1rem; margin-bottom: 1rem; opacity: 0.7; }
        .typing-dots { display: flex; gap: 4px; }
        .typing-dot { width: 8px; height: 8px; background: var(--brand-purple); border-radius: 50%; animation: typingPulse 1.4s infinite ease-in-out; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typingPulse { 0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }
        
        .response-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem; }
        .response-option { background: white; border: 2px solid #e2e8f0; border-radius: 15px; padding: 1.5rem; cursor: pointer; transition: all 0.3s ease; text-align: center; }
        .response-option:hover { border-color: var(--cta-turquoise); transform: translateY(-3px); box-shadow: 0 8px 25px rgba(64, 224, 208, 0.2); }
        .option-icon { font-size: 2rem; margin-bottom: 1rem; display: block; }
        .option-title { font-weight: 700; margin-bottom: 0.5rem; color: var(--text-dark); }
        .option-desc { font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; }
        
        .input-section { margin-top: 1.5rem; }
        .input-group { margin-bottom: 1rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark); }
        .chat-input { width: 100%; padding: 12px 16px; background: white; border: 2px solid #e2e8f0; border-radius: 12px; color: var(--text-dark); font-size: 1rem; transition: all 0.3s ease; font-family: var(--font-body); }
        .chat-input:focus { outline: none; border-color: var(--cta-turquoise); box-shadow: 0 0 0 3px rgba(64, 224, 208, 0.1); }
        
        .checkbox-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; margin-top: 1rem; }
        .checkbox-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.8rem; background: white; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; border: 1px solid #e2e8f0; }
        .checkbox-item:hover { background: var(--secondary-bg); border-color: var(--cta-turquoise); }
        .checkbox-item input[type="checkbox"] { accent-color: var(--cta-turquoise); }
        
        .range-input { width: 100%; margin: 1rem 0; height: 6px; background: #e2e8f0; border-radius: 3px; outline: none; cursor: pointer; }
        .range-display { text-align: center; font-size: 1.2rem; font-weight: 700; color: var(--cta-turquoise); margin: 0.5rem 0; }
        
        .continue-btn { background: linear-gradient(135deg, var(--cta-turquoise), #5ce1e6); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(64, 224, 208, 0.3); margin-top: 1rem; }
        .continue-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(64, 224, 208, 0.4); }
        
        .whatsapp-section { text-align: center; padding: 2rem; background: linear-gradient(135deg, rgba(37, 211, 102, 0.1), rgba(139, 95, 191, 0.1)); border-radius: 20px; margin-top: 2rem; }
        .whatsapp-icon { font-size: 4rem; color: #25d366; margin-bottom: 1rem; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } }
        .whatsapp-title { font-family: var(--font-heading); font-size: 2rem; margin-bottom: 1rem; color: var(--text-dark); }
        .whatsapp-preview { background: white; border: 1px solid #e2e8f0; border-radius: 15px; padding: 1.5rem; margin: 1.5rem 0; text-align: right; font-family: 'Courier New', monospace; line-height: 1.8; max-height: 300px; overflow-y: auto; }
        .whatsapp-btn { background: #25d366; color: white; padding: 18px 40px; border: none; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4); display: inline-flex; align-items: center; gap: 12px; text-decoration: none; }
        .whatsapp-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(37, 211, 102, 0.6); }

        /* Contact Info Section */
        .contact-info { padding: 4rem 2rem; background: white; }
        .contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; max-width: 900px; margin: 3rem auto 0; }
        .contact-card { text-align: center; padding: 2rem; background: var(--secondary-bg); border-radius: 20px; border: 1px solid #e2e8f0; transition: all 0.3s ease; }
        .contact-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(139, 95, 191, 0.15); }
        .contact-icon { width: 60px; height: 60px; background: linear-gradient(135deg, var(--brand-purple), #a78bca); border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; margin: 0 auto 1.5rem; }
        .contact-card h3 { font-size: 1.3rem; color: var(--text-dark); margin-bottom: 0.5rem; }
        .contact-card p { color: var(--text-muted); margin-bottom: 1rem; }
        .contact-card a { color: var(--brand-purple); text-decoration: none; font-weight: 600; }
        .contact-card a:hover { text-decoration: underline; }

        /* Footer */
        .footer { padding: 3rem 2rem; text-align: center; border-top: 1px solid #e2e8f0; background: var(--secondary-bg); }
        .footer-social { display: flex; justify-content: center; gap: 2rem; margin-bottom: 2rem; }
        .footer-social a { color: var(--text-muted); font-size: 1.5rem; transition: all 0.3s ease; }
        .footer-social a:hover { color: var(--brand-purple); transform: translateY(-2px); }
        .footer-links { margin: 1.5rem 0; }
        .footer-links a { color: var(--text-muted); text-decoration: none; margin: 0 10px; transition: color 0.3s ease; }
        .footer-links a:hover { text-decoration: underline; color: var(--brand-purple); }
        .footer-credit { font-size: 0.9rem; color: var(--brand-purple); margin-top: 1rem; }

        /* Floating WhatsApp */
        .floating-whatsapp { position: fixed; bottom: 30px; right: 30px; width: 70px; height: 70px; background: linear-gradient(135deg, #25d366, #128c7e); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4); z-index: 1000; transition: all 0.3s; text-decoration: none; }
        .floating-whatsapp:hover { transform: scale(1.15); box-shadow: 0 12px 35px rgba(37, 211, 102, 0.6); }

        /* Mobile Menu */
        .mobile-menu-toggle { display: none; flex-direction: column; gap: 5px; background: none; border: none; cursor: pointer; padding: 10px; }
        .hamburger-line { width: 30px; height: 3px; background: var(--text-dark); transition: 0.3s; border-radius: 2px; }

        @media (max-width: 768px) {
            .mobile-menu-toggle { display: flex; }
            .nav-menu { position: fixed; right: -100%; top: 80px; flex-direction: column; background: rgba(255, 255, 255, 0.98); width: 100%; padding: 20px; transition: 0.3s; border-top: 1px solid #e2e8f0; }
            .nav-menu.active { right: 0; }
            .nav-menu li { padding: 15px 0; border-bottom: 1px solid #e2e8f0; width: 100%; text-align: center; }
            .chat-messages { height: 400px; }
            .response-options { grid-template-columns: 1fr; }
            .checkbox-group { grid-template-columns: 1fr; }
            .contact-grid { grid-template-columns: 1fr; }
        }

        .chat-messages::-webkit-scrollbar { width: 8px; }
        .chat-messages::-webkit-scrollbar-track { background: #f1f1f1; }
        .chat-messages::-webkit-scrollbar-thumb { background: var(--brand-purple); border-radius: 4px; }
    </style>
</head>
<body>
    <header class="header-nav">
        <nav class="nav-content">
            <div class="logo-container">
                <img src="https://github.com/kfischi/MULTIBRAWN-V.1/raw/main/Gallery/לוגו2.png" alt="לוגו MULTIBRAWN" class="logo-img">
                <a href="index.html" class="logo">MULTIBRAWN</a>
            </div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="index.html">דף הבית</a></li>
                <li><a href="about.html">אודות</a></li>
                <li><a href="gallery.html">גלריה</a></li>
                <li><a href="marketing.html">שיווק</a></li>
                <li><a href="faq.html">שאלות ותשובות</a></li>
                <li><a href="contact.html" class="active">צור קשר</a></li>
            </ul>
            <button class="mobile-menu-toggle" id="mobileToggle">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </nav>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">בואו נדבר</h1>
            <p class="hero-subtitle">
                מחפשים לוקיישן מושלם? רוצים לשפר את השיווק הדיגיטלי?<br>
                ספרו לנו מה אתם צריכים ונעזור לכם להגשים את החלום
            </p>
        </div>
    </section>

    <section class="chat-section">
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-title">היועץ החכם שלנו</div>
                <div class="chat-subtitle">ענו על כמה שאלות ואנחנו נחזור אליכם עם הפתרון המושלם</div>
                <button class="restart-btn" onclick="location.reload()">התחל מחדש</button>
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">שלב 1 מתוך 7</div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="messages-container" id="messagesContainer">
                    <div class="typing-indicator" id="typingIndicator">
                        <div class="message-avatar">🤖</div>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                        <span>כותב...</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="contact-info">
        <div class="container">
            <h2 style="font-family: var(--font-heading); font-size: 2.5rem; text-align: center; color: var(--brand-purple); margin-bottom: 1rem;">דרכים נוספות ליצור קשר</h2>
            <p style="text-align: center; color: var(--text-muted); font-size: 1.1rem; margin-bottom: 2rem;">נשמח לשמוע מכם בכל דרך שנוחה לכם</p>
            
            <div class="contact-grid">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <h3>WhatsApp</h3>
                    <p>התכתבו איתנו ישירות</p>
                    <a href="https://wa.me/972523983394?text=שלום, אני מעוניין לשמוע עוד" target="_blank">שלחו הודעה</a>
                </div>

                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <h3>טלפון</h3>
                    <p>התקשרו אלינו ישירות</p>
                    <a href="tel:+972523983394">052-398-3394</a>
                </div>

                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h3>אימייל</h3>
                    <p>שלחו לנו הודעה</p>
                    <a href="mailto:info@multibrawn.com">info@multibrawn.com</a>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-social">
                <a href="#" title="פייסבוק"><i class="fab fa-facebook"></i></a>
                <a href="#" title="אינסטגרם"><i class="fab fa-instagram"></i></a>
                <a href="#" title="לינקדאין"><i class="fab fa-linkedin"></i></a>
            </div>
            <div class="footer-links">
                <a href="privacy.html">מדיניות פרטיות</a>
                <a href="accessibility.html">הצהרת נגישות</a>
            </div>
            <p style="color: var(--text-muted); margin: 1rem 0;">© 2025 Multibrawn. כל הזכויות שמורות.</p>
            <p class="footer-credit">האתר נבנה ע"י Multi-Site - אתרים שבונים עסקים מבית Multibrawn</p>
        </div>
    </footer>

    <a href="https://wa.me/972523983394?text=שלום, אני מעוניין לשמוע עוד" class="floating-whatsapp" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script>
        class ContactChat {
            constructor() {
                this.currentStep = 0;
                this.userResponses = {};
                this.messagesContainer = document.getElementById('messagesContainer');
                this.typingIndicator = document.getElementById('typingIndicator');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');

                this.conversationFlow = [
                    { id: 'welcome', botMessage: 'שלום וברוכים הבאים! 👋\n\nאני כאן כדי לעזור לכם למצוא את הפתרון המושלם.\n\nבמה אני יכול לעזור לכם היום?', responseType: 'options', options: [ { text: 'מחפש לוקיישן לחופשה/אירוע', value: 'vacation', icon: '🏖️', desc: 'וילה, צימר, דירת נופש או מתחם אירועים' }, { text: 'יש לי נכס ורוצה לשווק', value: 'property_owner', icon: '🏡', desc: 'שיתוף פעולה ושיווק דיגיטלי' }, { text: 'שירותי שיווק דיגיטלי', value: 'marketing', icon: '📱', desc: 'בניית אתרים, SEO, ניהול רשתות' } ] },
                    { id: 'property_type', botMessage: 'מעולה! 🎯\n\nאיזה סוג מקום אתם מחפשים?', responseType: 'options', options: [ { text: 'צימר רומנטי', value: 'zimmer', icon: '💕' }, { text: 'וילה פרטית', value: 'villa', icon: '🏡' }, { text: 'דירת נופש', value: 'apartment', icon: '🏢' }, { text: 'מלון בוטיק', value: 'hotel', icon: '🏨' }, { text: 'אולם/גן אירועים', value: 'event_venue', icon: '🎉' } ] },
                    { id: 'location', botMessage: 'נהדר! 📍\n\nבאיזה אזור בארץ?', responseType: 'options', options: [ { text: 'צפון', value: 'north', icon: '🏔️' }, { text: 'מרכז', value: 'center', icon: '🏙️' }, { text: 'ירושלים והסביבה', value: 'jerusalem', icon: '🕌' }, { text: 'דרום', value: 'south', icon: '🏜️' }, { text: 'לא משנה', value: 'anywhere', icon: '🌍' } ] },
                    { id: 'dates', botMessage: 'מתי אתם מתכננים להגיע? 📅', responseType: 'textarea', placeholder: 'למשל: סוף שבוע הבא, בחודש יוני, עוד לא בטוח...' },
                    { id: 'guests', botMessage: 'כמה אנשים יהיו? 👥', responseType: 'slider', sliderConfig: { min: 2, max: 200, default: 10, unit: 'אנשים', labels: { 2: 'זוג', 6: 'משפחה קטנה', 15: 'משפחה גדולה', 40: 'אירוע קטן', 100: 'אירוע גדול', 200: 'אירוע ענק' } } },
                    { id: 'special_requests', botMessage: 'יש דרישות מיוחדות? ✨\n\n(אופציונלי)', responseType: 'textarea', placeholder: 'למשל: כשרות, נגישות, חיות מחמד, בריכה פרטית...' },
                    { id: 'contact_info', botMessage: 'מעולה! עכשיו הפרטים שלכם 📞\n\nכדי שנוכל ליצור קשר ולעזור לכם:', responseType: 'form', fields: [ { type: 'text', name: 'name', label: 'שם מלא', placeholder: 'איך קוראים לכם?', required: true }, { type: 'tel', name: 'phone', label: 'טלפון', placeholder: '052-123-4567', required: true }, { type: 'email', name: 'email', label: 'אימייל', placeholder: 'your@email.com', required: false } ] }
                ];
                this.startConversation();
            }

            startConversation() {
                setTimeout(() => {
                    this.addBotMessage(this.conversationFlow[0].botMessage);
                    this.showResponseOptions(this.conversationFlow[0]);
                }, 1000);
                this.updateProgress();
            }

            addBotMessage(message) {
                this.showTyping();
                setTimeout(() => {
                    this.hideTyping();
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message bot';
                    messageDiv.innerHTML = '<div class="message-avatar">🤖</div><div class="message-bubble">' + message.replace(/\n/g, '<br>') + '</div>';
                    this.messagesContainer.appendChild(messageDiv);
                    this.scrollToBottom();
                }, 1500);
            }

            addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user';
                messageDiv.innerHTML = '<div class="message-bubble">' + message + '</div><div class="message-avatar">👤</div>';
                this.messagesContainer.appendChild(messageDiv);
                this.scrollToBottom();
            }

            showTyping() { this.typingIndicator.style.display = 'flex'; this.scrollToBottom(); }
            hideTyping() { this.typingIndicator.style.display = 'none'; }

            showResponseOptions(step) {
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'response-options';
                optionsDiv.id = 'currentOptions';

                if (step.responseType === 'options') {
                    step.options.forEach(option => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'response-option';
                        optionDiv.innerHTML = '<span class="option-icon">' + option.icon + '</span><div class="option-title">' + option.text + '</div>' + (option.desc ? '<div class="option-desc">' + option.desc + '</div>' : '');
                        optionDiv.onclick = () => this.handleOptionClick(option.value, option.text);
                        optionsDiv.appendChild(optionDiv);
                    });
                } else if (step.responseType === 'slider') {
                    optionsDiv.innerHTML = '<div class="input-section"><div class="input-group"><label class="input-label">' + step.sliderConfig.unit + ':</label><input type="range" class="range-input" id="rangeSlider" min="' + step.sliderConfig.min + '" max="' + step.sliderConfig.max + '" value="' + step.sliderConfig.default + '"><div class="range-display" id="rangeDisplay">' + step.sliderConfig.default + ' ' + step.sliderConfig.unit + '</div></div><button class="continue-btn" id="continueBtn">המשך</button></div>';
                    setTimeout(() => {
                        const slider = document.getElementById('rangeSlider');
                        const display = document.getElementById('rangeDisplay');
                        slider.oninput = (e) => {
                            const val = e.target.value;
                            display.textContent = val + ' ' + step.sliderConfig.unit;
                            for (const [t, l] of Object.entries(step.sliderConfig.labels)) {
                                if (val >= t) display.textContent = val + ' ' + step.sliderConfig.unit + ' (' + l + ')';
                            }
                        };
                        document.getElementById('continueBtn').onclick = () => this.handleOptionClick(slider.value, slider.value + ' ' + step.sliderConfig.unit);
                    }, 100);
                } else if (step.responseType === 'textarea') {
                    optionsDiv.innerHTML = '<div class="input-section"><div class="input-group"><textarea class="chat-input" id="textareaInput" placeholder="' + step.placeholder + '" rows="4"></textarea></div><button class="continue-btn" id="continueTextarea">המשך</button></div>';
                    setTimeout(() => document.getElementById('continueTextarea').onclick = () => {
                        const val = document.getElementById('textareaInput').value.trim();
                        this.handleOptionClick(val || 'לא צוין', val || 'לא צוין');
                    }, 100);
                } else if (step.responseType === 'form') {
                    optionsDiv.innerHTML = '<div class="input-section">' + step.fields.map(f => '<div class="input-group"><label class="input-label">' + f.label + '</label><input type="' + f.type + '" class="chat-input" name="' + f.name + '" placeholder="' + f.placeholder + '" ' + (f.required ? 'required' : '') + '></div>').join('') + '<button class="continue-btn" id="submitForm">שלח פרטים</button></div>';
                    setTimeout(() => document.getElementById('submitForm').onclick = () => this.handleFormSubmit(step.fields), 100);
                }

                this.messagesContainer.appendChild(optionsDiv);
                this.scrollToBottom();
            }

            handleOptionClick(value, displayText) {
                this.userResponses[this.conversationFlow[this.currentStep].id] = value;
                this.addUserMessage(displayText);
                const curr = document.getElementById('currentOptions');
                if (curr) curr.remove();
                this.currentStep++;
                this.proceedToNextStep();
            }

            handleFormSubmit(fields) {
                const formData = {};
                let isValid = true;
                const errors = [];

                fields.forEach(field => {
                    const input = document.querySelector('[name="' + field.name + '"]');
                    if (!input) return;
                    const val = input.value.trim();
                    input.style.borderColor = '#e2e8f0';

                    if (field.required && !val) {
                        isValid = false;
                        input.style.borderColor = '#ef4444';
                        errors.push('השדה "' + field.label + '" הוא חובה');
                        return;
                    }

                    if (field.name === 'phone' && val) {
                        let clean = val.replace(/[^0-9]/g, '');
                        if (clean.length < 9 || clean.length > 10) {
                            isValid = false;
                            input.style.borderColor = '#ef4444';
                            errors.push('מספר הטלפון לא תקין');
                        } else {
                            formData[field.name] = clean;
                            return;
                        }
                    }

                    if (field.name === 'email' && val && (!val.includes('@') || !val.includes('.'))) {
                        isValid = false;
                        input.style.borderColor = '#ef4444';
                        errors.push('כתובת האימייל לא תקינה');
                    }

                    formData[field.name] = val;
                });

                if (!isValid) {
                    this.addBotMessage('אופס! יש כמה בעיות בפרטים:\n\n• ' + errors.join('\n• ') + '\n\nאנא תקנו ונסו שוב.');
                    return;
                }

                this.userResponses.contactInfo = formData;
                let txt = 'שם: ' + formData.name + '\nטלפון: ' + formData.phone;
                if (formData.email) txt += '\nאימייל: ' + formData.email;
                this.addUserMessage(txt);

                const curr = document.getElementById('currentOptions');
                if (curr) curr.remove();
                this.currentStep++;
                this.proceedToNextStep();
            }

            proceedToNextStep() {
                if (this.currentStep < this.conversationFlow.length) {
                    const next = this.conversationFlow[this.currentStep];
                    this.updateProgress();
                    setTimeout(() => {
                        this.addBotMessage(next.botMessage);
                        setTimeout(() => this.showResponseOptions(next), 1500);
                    }, 500);
                } else {
                    this.generateFinalMessage();
                }
            }

            createWhatsAppMessage() {
                const r = this.userResponses;
                const c = r.contactInfo || {};
                let msg = '📞 פנייה חדשה מאתר MULTIBRAWN\n\n';
                msg += '👤 פרטי הלקוח:\n';
                msg += '• שם: ' + c.name + '\n';
                msg += '• טלפון: ' + c.phone + '\n';
                if (c.email) msg += '• אימייל: ' + c.email + '\n';
                
                msg += '\n🎯 סוג הפנייה: ';
                const welcomeTypes = { vacation: 'חיפוש לוקיישן לחופשה/אירוע', property_owner: 'בעלים של נכס מעוניין בשיתוף פעולה', marketing: 'עניין בשירותי שיווק דיגיטלי' };
                msg += welcomeTypes[r.welcome] || r.welcome;
                msg += '\n';

                if (r.property_type) {
                    const types = { zimmer: 'צימר רומנטי', villa: 'וילה פרטית', apartment: 'דירת נופש', hotel: 'מלון בוטיק', event_venue: 'אולם/גן אירועים' };
                    msg += '\n🏡 סוג המקום: ' + (types[r.property_type] || r.property_type) + '\n';
                }
                
                if (r.location) {
                    const locs = { north: 'צפון', center: 'מרכז', jerusalem: 'ירושלים והסביבה', south: 'דרום', anywhere: 'לא משנה' };
                    msg += '📍 אזור: ' + (locs[r.location] || r.location) + '\n';
                }
                
                if (r.dates && r.dates !== 'לא צוין') msg += '📅 תאריכים: ' + r.dates + '\n';
                if (r.guests) msg += '👥 מספר אורחים: ' + r.guests + '\n';
                if (r.special_requests && r.special_requests !== 'לא צוין') msg += '✨ דרישות מיוחדות: ' + r.special_requests + '\n';
                
                msg += '\n🤝 מחכים ליצור קשר!';
                return msg;
            }

            generateFinalMessage() {
                this.addBotMessage('מושלם! תנו לי רגע לכתוב עבורכם סיכום מפורט...');
                setTimeout(() => {
                    const msg = this.createWhatsAppMessage();
                    const sec = document.createElement('div');
                    sec.className = 'whatsapp-section';
                    sec.innerHTML = '<div class="whatsapp-icon">💬</div><h3 class="whatsapp-title">הבקשה שלכם מוכנה!</h3><p style="color:var(--text-muted);margin-bottom:1rem">הנה סיכום הפרטים שמסרתם</p><div class="whatsapp-preview">' + msg.replace(/\n/g, '<br>') + '</div><a href="https://wa.me/972523983394?text=' + encodeURIComponent(msg) + '" class="whatsapp-btn" target="_blank"><i class="fab fa-whatsapp"></i> שלח ב-WhatsApp</a>';
                    this.messagesContainer.appendChild(sec);
                    this.scrollToBottom();
                }, 2000);
            }

            updateProgress() {
                const total = this.conversationFlow.length;
                const prog = (this.currentStep / total) * 100;
                this.progressFill.style.width = prog + '%';
                this.progressText.textContent = 'שלב ' + (this.currentStep + 1) + ' מתוך ' + total;
            }

            scrollToBottom() { setTimeout(() => { document.getElementById('chatMessages').scrollTop = 999999; }, 100); }
        }

        document.addEventListener('DOMContentLoaded', function() {
            new ContactChat();
            
            const toggle = document.getElementById('mobileToggle');
            const menu = document.getElementById('navMenu');
            if (toggle && menu) toggle.onclick = () => menu.classList.toggle('active');
            
            document.querySelectorAll('a[href^="#"]').forEach(a => a.onclick = function(e) {
                e.preventDefault();
                const t = document.querySelector(this.getAttribute('href'));
                if (t) t.scrollIntoView({ behavior: 'smooth' });
            });
            
            window.onscroll = () => {
                const nav = document.querySelector('.header-nav');
                nav.style.background = window.scrollY > 100 ? 'rgba(255,255,255,0.95)' : 'rgba(255,255,255,0.9)';
            };
        });
    </script>
</body>
</html>
